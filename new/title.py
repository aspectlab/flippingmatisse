import os
from PIL import Image, ImageFont, ImageDraw 

width = 410
names = ["1335","1249_essai","1249_essai_10","1249_4","1249_5","1265_essai","1265_4","1253_essai_a","1253_essai_b","1253_epreuve_5","1253_4","1256_essai","1256_essai_japon","1256_4","1256_8","1294_essai","1294_epreuve_8","1294_4","1294_7","1294_10","1294_29","1294_40","1294_41","1295_essai","1295_7","1295_13","1295_20","1295_25","1295_26","1295_32","1295_38","1295_41","1295_46","1296_essai","1296_epreuve_6","1296_9_treated","1296_16","1296_28_treated","1296_32","1298_essai","1298_epeuve_7","1298_5","1298_49","1298_50","1299_essai","1299_19","1299_24","1299_42","1299_50","1300_4","1300_6","1300_34","1300_81","1300_83","1301_essai_a","1301_essai_b","1301_essai_japon","1301_5","1301_39","1301_45","1301_50","1313_essai","1313_epreuve_10","1313_4","1313_13","1324_essai_japon","1324_essai","1324_premier_etat","1324_7","1324_40","1324_41","1324_66","1324_72","1324_73","1331_essai_japon","1331_essai_a","1331_essai_b","1331_epreuve_8","1331_10","1327_18","1327_29","1327_35","1327_41","1327_49","1327_64","1327_68","1368_epeuve_1","1368_1","1368_6","2592_essai_a","2592_essai_b","2592_13","2592_6","2591_essai","2591_epreuve_6","2591_6","2591_16","2594_essai","2594_3","2594_7","2595_essai","2595_6","2595_12","2595_20","1348_essai","1348_18","1348_21","2596_essai","2596_3","2596_12","2596_18","1358_essai","1358_2","1358_16","1358_23","1359_essai","1359_14","1359_5","1359_22","1360_essai","1360_11","1360_9","1361_essai","1361_12","1361_16","1361_19","1361_24","1362_essai","1362_13","1362_17","1362_20","1362_22","1363_essai","1363_8","1363_14","1387_epreuve_4","1387_10","1387_18","1387_22","1403_4","1403_13","1403_21","1403_32","1403_33","2599_essai","2599_epreuve_5","2599_5","2599_23","2600_essai","2600_4","2600_10","2600_19","2601_essai","2601_epreuve_5","2601_9","2601_16","2602_epreuve_3","2602_essai","2602_4","2602_24","2603_essai","2603_3","2603_12","2603_21","2605_essai","2605_1","2605_10","2605_19","2606_essai","2606_epreuve_6","2606_7","2606_16","2607_essai","2607_epreuve_4","2607_8","2607_18","2608_essai","2608_epreuve_1","2608_6","2608_17","2609_epreuve_2","2609_7","2609_11","2609_23","2610_5","2610_11","2610_23","1364_1","1364_16","1364_20","1364_23","1365_11","1365_16","1366_6","1366_12","1366_18","1366_20","1367_epeuve_2","1367_3","1367_8","1367_21","1367_24","2597_essai","2597_1","2597_9","2597_21","2598_essai_a","2598_essai_b","2598_19","2598_4","1297_essai_japon","2589_essai","2589_3","2589_11","2589_18"]
numtex=[1, 4, 2, 4, 4, 8, 10, 6, 5, 5, 5, 7, 4, 9, 5, 7, 3, 4, 4, 3, 4, 3, 4, 4, 4, 3, 5, 5, 3, 4, 5, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 3, 4, 2, 4, 5, 4, 4, 1, 4]
cumsum=[1, 5, 7, 11, 15, 23, 33, 39, 44, 49, 54, 61, 65, 74, 79, 86, 89, 93, 97, 100, 104, 107, 111, 115, 119, 122, 127, 132, 135, 139, 144, 148, 152, 156, 160, 164, 168, 172, 176, 180, 184, 187, 191, 193, 197, 202, 206, 210, 211, 215]
ednames=["1335","1249","1265","1253","1256","1294","1295","1296","1298","1299","1300","1301","1313","1324","1331","1327","1368","2592","2591","2594","2595","1348","2596","1358","1359","1360","1361","1362","1363","1387","1403","2599","2600","2601","2602","2603","2605","2606","2607","2608","2609","2610","1364","1365","1366","1367","2597","2598","1297","2589"]
fontName = 'Courier_New_Bold.ttf'


longName = max(names, key=len)
numNames = len(names)

# figure out appropriate font size to fit
fontSize = 0
w = 0
while w < width:
    fontSize = fontSize + 1    
    font = ImageFont.truetype(fontName, size=fontSize+1)
    (w, _) = font.getsize(longName)

font = ImageFont.truetype(fontName, size=fontSize)

# determine height, add 20 pixel buffer (10 top, 10 bottom)
(_, height) = font.getsize(longName)
height = height + 20

for ed in range(0,50):
    image = Image.new('RGB', (width*numtex[ed], height), (255,255,255))
    image_editable = ImageDraw.Draw(image)
    for i in range(0,numtex[ed]):
        (w, _) = font.getsize(names[cumsum[ed]-i-1])    
        image_editable.text((i*width+(width-w)//2,10), names[cumsum[ed]-i-1], 0, font=font)
        
    image = image.transpose(method=Image.ROTATE_90)
    image.save('temp.png')
    
    os.system('convert +append temp.png ' + ednames[ed] + '_flip.png temp2.png')
    os.system('mv temp2.png ' + ednames[ed] + '_flip.png')
    os.system('convert +append temp.png ' + ednames[ed] + '_orig.png temp2.png')
    os.system('mv temp2.png ' + ednames[ed] + '_orig.png')

os.system('rm temp.png')
os.system('rm temp2.png')
